<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SuperCLI</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="node_modules/@xterm/xterm/css/xterm.css">
</head>
<body>
  <div class="app-container">
    <!-- CLI Selection Modal -->
    <div class="modal" id="cliModal">
      <div class="modal-content">
        <h2>Select AI Coding CLI</h2>
        <p class="modal-subtitle">Choose which CLI to launch for this tab</p>
        <div class="cli-options">
          <button class="cli-option" data-cli="claude">
            <div class="cli-icon">ü§ñ</div>
            <div class="cli-name">Claude</div>
          </button>
          <button class="cli-option" data-cli="codex">
            <div class="cli-icon">üíª</div>
            <div class="cli-name">Codex</div>
          </button>
          <button class="cli-option" data-cli="gemini">
            <div class="cli-icon">‚ú®</div>
            <div class="cli-name">Gemini</div>
          </button>
          <button class="cli-option" data-cli="custom">
            <div class="cli-icon">‚öôÔ∏è</div>
            <div class="cli-name">Custom</div>
          </button>
        </div>
        <div class="custom-cli-input" id="customCliInput" style="display: none;">
          <input type="text" id="customCliCommand" placeholder="Enter custom CLI command (e.g., aider, cursor-chat)" />
        </div>
        <label class="new-project-toggle" for="newProjectCheckbox">
          <input type="checkbox" id="newProjectCheckbox" />
          <div class="new-project-copy">
            <span class="new-project-title">New project</span>
            <span class="new-project-hint">Pick a different folder before launching this tab</span>
          </div>
        </label>
        <div class="modal-actions">
          <button class="modal-btn modal-cancel" id="modalCancel">Cancel</button>
          <button class="modal-btn modal-confirm" id="modalConfirm">Launch</button>
        </div>
      </div>
    </div>

    <!-- Header with tabs -->
    <div class="header">
      <div class="tabs-container">
        <div class="project-select">
          <select id="projectSelector" title="Select project"></select>
        </div>
        <div class="tabs" id="tabs"></div>
        <button class="new-tab-btn" id="newTabBtn" title="New AI CLI">+</button>
      </div>
      <div class="project-info">
        <span class="project-path" id="projectPath">No project selected</span>
        <button class="project-btn" id="todoBtn" title="Show/Hide TODO">Todo</button>
        <button class="project-btn" id="settingsBtn" title="Settings">Settings</button>
        <button class="debug-btn" id="debugBtn" title="Open DevTools">Debug Tools</button>
      </div>
    </div>

    <!-- Terminal display area -->
    <div class="terminal-container" id="terminalContainer"></div>

    <!-- Todo side panel -->
    <div class="todo-panel" id="todoPanel">
      <div class="todo-header">
        <span class="todo-title">Project TODO</span>
        <button class="todo-close" id="todoCloseBtn" title="Close">√ó</button>
      </div>
      <div class="todo-body">
        <div id="todoEmptyState" class="todo-empty">No items yet. Add one below.</div>
        <div id="todoList" class="todo-list"></div>
      </div>
      <div class="todo-footer">
        <input id="todoAddSection" class="todo-input" type="text" placeholder="section (optional)" />
        <input id="todoAddInput" class="todo-input" type="text" placeholder="Add a new todo" />
        <button id="todoReloadBtn" class="todo-add-btn" title="Reload from disk">Reload</button>
        <button id="todoSaveBtn" class="todo-add-btn" title="Save to TODO.md">Save</button>
        <button id="todoAddBtn" class="todo-add-btn">Add</button>
      </div>
    </div>

    <!-- Input area at bottom -->
    <div class="input-container">
      <div class="input-wrapper">
        <textarea
          class="input-field"
          id="inputField"
          placeholder="Type commands here to see them logged... (The AI CLI runs in the external window)"
          rows="1"
        ></textarea>
        <button class="send-btn" id="sendBtn">Send</button>
      </div>
      <div class="input-info">
        <span id="inputInfo">Ready</span>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div class="modal" id="settingsModal">
    <div class="modal-content settings">
      <h2>Settings</h2>
      <p class="modal-subtitle">Project .user preferences and rules</p>
      <div class="settings-meta">
        <span>Active project: </span><span id="settingsProjectName">None</span>
      </div>
      <div class="settings-section">
        <h3 class="settings-subhead">General</h3>
        <div class="settings-grid">
          <label for="profileName">Profile name</label>
          <input id="profileName" class="settings-input" type="text" placeholder="Your name" />

          <label for="profileNotes">Notes</label>
          <input id="profileNotes" class="settings-input" type="text" placeholder="Notes about this project" />

          <label>Restore session on launch</label>
          <input id="restoreOnLaunch" type="checkbox" class="settings-checkbox" />

          <label>Remember window bounds</label>
          <input id="rememberWindowBounds" type="checkbox" class="settings-checkbox" />

          <label for="themeSelect">Theme</label>
          <select id="themeSelect" class="settings-select">
            <option value="dark">Dark</option>
            <option value="light">Light</option>
            <option value="deep-blue">Deep Blue</option>
            <option value="light-grey">Light Grey</option>
            <option value="end-times">End Times</option>
          </select>

          <label for="fontSize">Font size</label>
          <input id="fontSize" class="settings-input" type="number" min="8" max="28" step="1" />
        </div>
      </div>

      <div class="settings-section">
        <h3 class="settings-subhead">Python</h3>
        <div class="settings-grid">
          <label for="pyDepThreshold">Auto-venv when deps ‚â•</label>
          <input id="pyDepThreshold" class="settings-input" type="number" min="0" step="1" />

          <label for="pyVenvDir">Venv directory</label>
          <input id="pyVenvDir" class="settings-input" type="text" placeholder=".venv" />

          <label for="pyExe">Python executable</label>
          <input id="pyExe" class="settings-input" type="text" placeholder="python" />

          <label>Use requirements.txt</label>
          <input id="pyUseReq" type="checkbox" class="settings-checkbox" />

          <label for="pyEntrypoint">Entry point</label>
          <input id="pyEntrypoint" class="settings-input" type="text" placeholder="main.py" />

          <label>Include script templates</label>
          <input id="pyIncludeTemplates" type="checkbox" class="settings-checkbox" />
        </div>
        <div class="settings-grid full">
          <label for="pyInstallBat">install.bat template</label>
          <textarea id="pyInstallBat" class="settings-textarea small" spellcheck="false"></textarea>

          <label for="pyRunBat">run.bat template</label>
          <textarea id="pyRunBat" class="settings-textarea small" spellcheck="false"></textarea>
        </div>
        <div class="modal-actions">
          <button class="modal-btn" id="settingsGenDefaults">Fill default Python templates</button>
        </div>
      </div>

      <div class="settings-section">
        <h3 class="settings-subhead">Backup</h3>
        <div class="settings-grid">
          <label>Enable automatic backups</label>
          <input id="backupEnabled" type="checkbox" class="settings-checkbox" />

          <label for="backupInterval">Backup interval (minutes)</label>
          <input id="backupInterval" class="settings-input" type="number" min="1" step="1" placeholder="60" />

          <label for="backupRetention">Keep last N backups</label>
          <input id="backupRetention" class="settings-input" type="number" min="1" step="1" placeholder="4" />

          <label for="backupTargetDir">Backup directory</label>
          <input id="backupTargetDir" class="settings-input" type="text" placeholder=".supercli/backups" />

          <label>Compress backups (ZIP)</label>
          <input id="backupCompress" type="checkbox" class="settings-checkbox" />
        </div>
        <p class="settings-hint">Backups include .supercli/** and TODO.md by default. Files are timestamped and rotated based on retention count.</p>
      </div>

      <div class="settings-section">
        <label class="settings-label"><input type="checkbox" id="settingsShowJson" /> Advanced: show raw .user JSON</label>
        <textarea id="settingsUserJson" class="settings-textarea" style="display:none" spellcheck="false" placeholder="{\n  \"version\": 1,\n  ...\n}"></textarea>
        <p class="settings-hint">Project-level .user overrides home (~/.supercli.user). Save writes to project .user.</p>
      </div>
      <div class="modal-actions">
        <button class="modal-btn modal-cancel" id="settingsReload">Reload</button>
        <button class="modal-btn modal-confirm" id="settingsSave">Save</button>
        <button class="modal-btn" id="settingsClose">Close</button>
      </div>
    </div>
  </div>

  <script src="renderer.js"></script>
</body>
</html>
